# .gitlab-ci.yml - Mirror to GitHub for Amplify
image: alpine/git

stages:
  - mirror

variables:
  GIT_DEPTH: 0

mirror_to_github:
  stage: mirror
  before_script:
    - git config --global user.email "huydd@iceteasoftware.com"
    - git config --global user.name "huyddits"
  script:
    - echo "üîÑ Mirroring to GitHub for Amplify..."
    
    # Add GitHub remote
    - git remote add github https://$GITHUB_USERNAME:$GITHUB_TOKEN@${GITHUB_REPO_URL#https://}
    
    # Push to GitHub
    - git push github HEAD:$CI_COMMIT_REF_NAME --force
    - git push github --tags --force
    
    - echo "‚úÖ Successfully mirrored to GitHub"
    - echo "üåê GitHub URL: $GITHUB_REPO_URL"
    
  only:
    - staging
    - uat